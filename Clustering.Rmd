---
title: "Clustering"
date: "11/11/2021"
output:
  html_document: default
---


```{r}
library(here)
library(ggplot2)
library(dplyr)

table15_1 <- readr::read_table(here('ma_book_data', 'T15_1_CITYCRIME.dat'),
                               # delim = "\t",
                             col_names = c("city", "murder", "rape", "robbery", "assault", "burglary", "arceny", "autotheft"))

mat_15_1 <- as.matrix(table15_1[, -1])
rownames(mat_15_1) <- table15_1$city
```



```{r}
mat_15_1
```

```{r}
dist_mat_15_1 <- dist(mat_15_1, method = "euclidean")
```

```{r}
single_link <- hclust(dist_mat_15_1, method = "single")
```


```{r}
plot(single_link)
```

```{r}
plot(as.dendrogram(single_link))
```



```{r}
hclust_method <- c("single", "complete", "average", "centroid", "median", "ward.D")
names(hclust_method) <- hclust_method

all_clust <- purrr::map(hclust_method, ~hclust(d = dist_mat_15_1, method = .x))

```

```{r, out.width = '50%', fig.show='hold'}
purrr::walk(all_clust, plot)
```


